<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Optimization · InfiniteOpt.jl</title><script async src="https://www.googletagmanager.com/gtag/js?id=UA-178297470-1"></script><script>  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-178297470-1', {'page_path': location.pathname + location.search + location.hash});
</script><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/extra_styles.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img class="docs-light-only" src="../../assets/logo.png" alt="InfiniteOpt.jl logo"/><img class="docs-dark-only" src="../../assets/logo-dark.png" alt="InfiniteOpt.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">InfiniteOpt.jl</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../install/">Installation</a></li><li><input class="collapse-toggle" id="menuitem-3" type="checkbox"/><label class="tocitem" for="menuitem-3"><span class="docs-label">Tutorials</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../tutorials/quick_start/">Quick Start</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4" type="checkbox"/><label class="tocitem" for="menuitem-4"><span class="docs-label">Examples</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-4-1" type="checkbox"/><label class="tocitem" for="menuitem-4-1"><span class="docs-label">Optimal Control</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../examples/Optimal Control/consumption_savings/">Consumption Savings Problem</a></li><li><a class="tocitem" href="../../examples/Optimal Control/hovercraft/">Hovercraft Path Planning</a></li><li><a class="tocitem" href="../../examples/Optimal Control/pandemic_control/">Pandemic Control</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-2" type="checkbox"/><label class="tocitem" for="menuitem-4-2"><span class="docs-label">Stochastic Optimization</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../examples/Stochastic Optimization/farmer/">Two-Stage Stochastic Program</a></li><li><a class="tocitem" href="../../examples/Stochastic Optimization/flexible_design/">Power Network Flexibility Design</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-5" type="checkbox" checked/><label class="tocitem" for="menuitem-5"><span class="docs-label">User Guide</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../model/">Infinite Models</a></li><li><a class="tocitem" href="../domains/">Infinite Domains</a></li><li><a class="tocitem" href="../parameter/">Infinite Parameters</a></li><li><a class="tocitem" href="../finite_parameter/">Finite Parameters</a></li><li><a class="tocitem" href="../variable/">Variables</a></li><li><a class="tocitem" href="../derivative/">Derivatives</a></li><li><a class="tocitem" href="../expression/">Expressions</a></li><li><a class="tocitem" href="../measure/">Measures</a></li><li><a class="tocitem" href="../objective/">Objectives</a></li><li><a class="tocitem" href="../constraint/">Constraints</a></li><li><a class="tocitem" href="../transcribe/">Model Transcription</a></li><li class="is-active"><a class="tocitem" href>Optimization</a><ul class="internal"><li><a class="tocitem" href="#Overview"><span>Overview</span></a></li><li><a class="tocitem" href="#Basic-Usage"><span>Basic Usage</span></a></li><li><a class="tocitem" href="#Optimizer-Models"><span>Optimizer Models</span></a></li><li><a class="tocitem" href="#opt_settings"><span>Optimizer Settings</span></a></li></ul></li><li><a class="tocitem" href="../result/">Results</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6" type="checkbox"/><label class="tocitem" for="menuitem-6"><span class="docs-label">API Manual</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../manual/model/">Infinite Models</a></li><li><a class="tocitem" href="../../manual/domains/">Infinite Domains</a></li><li><a class="tocitem" href="../../manual/parameter/">Infinite Parameters</a></li><li><a class="tocitem" href="../../manual/finite_parameter/">Finite Parameters</a></li><li><a class="tocitem" href="../../manual/variable/">Variables</a></li><li><a class="tocitem" href="../../manual/derivative/">Derivatives</a></li><li><a class="tocitem" href="../../manual/expression/">Expressions</a></li><li><a class="tocitem" href="../../manual/measure/">Measures</a></li><li><a class="tocitem" href="../../manual/objective/">Objectives</a></li><li><a class="tocitem" href="../../manual/constraint/">Constraints</a></li><li><a class="tocitem" href="../../manual/transcribe/">Model Transcription</a></li><li><a class="tocitem" href="../../manual/optimize/">Optimization</a></li><li><a class="tocitem" href="../../manual/result/">Results</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-7" type="checkbox"/><label class="tocitem" for="menuitem-7"><span class="docs-label">Development</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../develop/extensions/">Extensions</a></li><li><a class="tocitem" href="../../develop/start_guide/">Getting Started</a></li><li><a class="tocitem" href="../../develop/style/">Style Guide</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">User Guide</a></li><li class="is-active"><a href>Optimization</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Optimization</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/pulsipher/InfiniteOpt.jl/blob/master/docs/src/guide/optimize.md#L" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="opt_docs"><a class="docs-heading-anchor" href="#opt_docs">Optimization</a><a id="opt_docs-1"></a><a class="docs-heading-anchor-permalink" href="#opt_docs" title="Permalink"></a></h1><p>A guide for optimizing (solving) <code>InfiniteOpt</code> models. See the respective  <a href="../../manual/optimize/#opt_manual">technical manual</a> for more details.</p><h2 id="Overview"><a class="docs-heading-anchor" href="#Overview">Overview</a><a id="Overview-1"></a><a class="docs-heading-anchor-permalink" href="#Overview" title="Permalink"></a></h2><p>Fundamentally, we seek to optimize a given infinite optimization model that  we have defined and this is the very reason why <code>InfiniteOpt</code> was created. Thus,  <code>InfiniteOpt</code> offers a general and intuitive platform to do just this. This  is made up of transforming the <code>InfiniteModel</code> into a standard optimization  problem stored as a <code>JuMP.Model</code> (referred to as the <code>optimizer_model</code>) that is  then optimized via a compatible optimizer. By default this is done via a  <code>TranscriptionModel</code> as described on the previous page. However, user-defined  reformulation strategies can readily be implemented as described in the  <a href="../../develop/extensions/#extend_optimizer_model">Optimizer Models</a> section on the extensions page. </p><h2 id="Basic-Usage"><a class="docs-heading-anchor" href="#Basic-Usage">Basic Usage</a><a id="Basic-Usage-1"></a><a class="docs-heading-anchor-permalink" href="#Basic-Usage" title="Permalink"></a></h2><p>For most users, <a href="../../manual/optimize/#JuMP.optimize!-Tuple{InfiniteModel}"><code>optimize!</code></a> is the only  method required to optimize an <code>InfiniteModel</code>. This is exactly analogous  to that of any <code>JuMP.Model</code> and is designed to provide a similar user experience.  Let&#39;s first define an <code>InfiniteModel</code> with an appropriate optimizer:</p><pre><code class="language-julia-repl">julia&gt; using InfiniteOpt, Ipopt;

julia&gt; model = InfiniteModel(Ipopt.Optimizer);

julia&gt; set_optimizer_attribute(model, &quot;print_level&quot;, 0);

julia&gt; @infinite_parameter(model, t in [0, 10], num_supports = 10);

julia&gt; @variable(model, y &gt;= 0, Infinite(t));

julia&gt; @variable(model, z &gt;= 0);

julia&gt; @objective(model, Min, 2z);

julia&gt; @constraint(model, c1, z &gt;= y);

julia&gt; @constraint(model, c2, y(0) == 42);

julia&gt; print(model)
Min 2 z
Subject to
 y(t) ≥ 0.0, ∀ t ∈ [0, 10]
 z ≥ 0.0
 c1 : z - y(t) ≥ 0.0, ∀ t ∈ [0, 10]
 y(0) ≥ 0.0
 c2 : y(0) = 42.0</code></pre><p>Now we optimize the model using <code>optimize!</code>:</p><pre><code class="language-julia-repl">julia&gt; optimize!(model);

julia&gt; termination_status(model)
LOCALLY_SOLVED::TerminationStatusCode = 4</code></pre><p>Now our model has been solved and we can query the solution. How to query the  solution is explained on the <a href="../result/#result_docs">Results</a> page.</p><p>If no optimizer has been specified for the <code>InfiniteModel</code>, one can be provided  via <a href="../../manual/optimize/#JuMP.set_optimizer-Tuple{InfiniteModel, Any}"><code>set_optimizer</code></a>:</p><pre><code class="language-julia-repl">julia&gt; set_optimizer(model, Ipopt.Optimizer)</code></pre><p>A number of methods also exist to adjust the optimizer settings such as  suppressing output. This is explained below in the  <a href="#opt_settings">Optimizer Settings</a> section.</p><h2 id="Optimizer-Models"><a class="docs-heading-anchor" href="#Optimizer-Models">Optimizer Models</a><a id="Optimizer-Models-1"></a><a class="docs-heading-anchor-permalink" href="#Optimizer-Models" title="Permalink"></a></h2><p>As discussed previously, <code>InfiniteModel</code>s contain an <code>optimizer_model</code> field  which stores a transformed finite version of the model in a <code>JuMP.Model</code> that  contains a data object (that stores a mapping between the transformed model and  the infinite model) in the <code>Model.ext</code> dictionary with an associated key. By  default a <code>JuMP.Model</code> using <a href="../../manual/transcribe/#InfiniteOpt.TranscriptionOpt.TranscriptionData"><code>TranscriptionData</code></a> stored under the key  <code>:TransData</code> is used and is referred to as a <code>TranscriptionModel</code>. The  optimizer model is then what is used to optimize the infinite model and it provides  the information exacted by solution queries mapped back to the infinite  model using the mapping data structure.</p><p>The process for optimizing an <code>InfiniteModel</code> is summarized in the following  steps:</p><ol><li>fully define the <code>InfiniteModel</code></li><li>build the optimizer model via <a href="../../manual/optimize/#InfiniteOpt.build_optimizer_model!"><code>build_optimizer_model!</code></a></li><li>optimize the <code>optimizer_model</code> via <a href="../../manual/optimize/#JuMP.optimize!-Tuple{InfiniteModel}"><code>optimize!</code></a>.</li></ol><p>Here <code>build_optimizer_model!</code> creates a reformulated finite version of the  <code>InfiniteModel</code>, stores it in <code>InfiniteModel.optimizer_model</code> via  <a href="../../manual/optimize/#InfiniteOpt.set_optimizer_model"><code>set_optimizer_model</code></a>, and indicates that the optimizer model is ready  via <a href="../../manual/optimize/#InfiniteOpt.set_optimizer_model_ready"><code>set_optimizer_model_ready</code></a>. These steps are all automated when  <a href="../../manual/optimize/#JuMP.optimize!-Tuple{InfiniteModel}"><code>optimize!</code></a> is invoked on the  <code>InfiniteModel</code>.</p><p>The <code>optimizer_model</code> can be queried/extracted at any time from an <code>InfiniteModel</code>  via <a href="../../manual/optimize/#InfiniteOpt.optimizer_model"><code>optimizer_model</code></a>. For example, let&#39;s extract the optimizer model  from the example above in the basic usage section: </p><pre><code class="language-julia-repl">julia&gt; trans_model = optimizer_model(model)
A JuMP Model
Minimization problem with:
Variables: 11
Objective function type: AffExpr
`AffExpr`-in-`MathOptInterface.EqualTo{Float64}`: 1 constraint
`AffExpr`-in-`MathOptInterface.GreaterThan{Float64}`: 10 constraints
`VariableRef`-in-`MathOptInterface.GreaterThan{Float64}`: 11 constraints
Model mode: AUTOMATIC
CachingOptimizer state: ATTACHED_OPTIMIZER
Solver name: Ipopt</code></pre><p>The <code>JuMP</code> variable(s) stored in the optimizer model that correspond to a  particular <code>InfiniteOpt</code> variable can be queried via  <a href="../../manual/optimize/#InfiniteOpt.optimizer_model_variable-Tuple{GeneralVariableRef}"><code>optimizer_model_variable</code></a>.  Using a <code>TranscriptionModel</code> this equivalent to calling  <a href="../../manual/transcribe/#InfiniteOpt.TranscriptionOpt.transcription_variable-Tuple{Model, GeneralVariableRef}"><code>transcription_variable</code></a>. Thus, using the going example we get:</p><pre><code class="language-julia-repl">julia&gt; optimizer_model_variable(y) # infinite variable
10-element Vector{VariableRef}:
 y(support: 1)
 y(support: 2)
 y(support: 3)
 y(support: 4)
 y(support: 5)
 y(support: 6)
 y(support: 7)
 y(support: 8)
 y(support: 9)
 y(support: 10)

julia&gt; optimizer_model_variable(z) # finite variable
z</code></pre><p>In like manner, we get the <code>JuMP</code> constraints corresponding to a particular  <code>InfiniteOpt</code> constraint via  <a href="../../manual/optimize/#InfiniteOpt.optimizer_model_constraint-Tuple{InfOptConstraintRef}"><code>optimizer_model_constraint</code></a>.  Using a <code>TranscriptionModel</code> this equivalent to calling  <a href="../../manual/transcribe/#InfiniteOpt.TranscriptionOpt.transcription_constraint-Tuple{Model, InfOptConstraintRef}"><code>transcription_constraint</code></a>. Thus, using going example we get: </p><pre><code class="language-julia-repl">julia&gt; optimizer_model_constraint(c1) # infinite constraint
10-element Vector{ConstraintRef}:
 c1(support: 1) : z - y(support: 1) ≥ 0.0
 c1(support: 2) : z - y(support: 2) ≥ 0.0
 c1(support: 3) : z - y(support: 3) ≥ 0.0
 c1(support: 4) : z - y(support: 4) ≥ 0.0
 c1(support: 5) : z - y(support: 5) ≥ 0.0
 c1(support: 6) : z - y(support: 6) ≥ 0.0
 c1(support: 7) : z - y(support: 7) ≥ 0.0
 c1(support: 8) : z - y(support: 8) ≥ 0.0
 c1(support: 9) : z - y(support: 9) ≥ 0.0
 c1(support: 10) : z - y(support: 10) ≥ 0.0</code></pre><p>We can also query the expressions via  <a href="../../manual/optimize/#InfiniteOpt.optimizer_model_expression-Tuple{AbstractJuMPScalar}"><code>optimizer_model_expression</code></a>:</p><pre><code class="language-julia-repl">julia&gt; optimizer_model_expression(z - y^2 + 3) # infinite expression
10-element Vector{AbstractJuMPScalar}:
 -y(support: 1)² + z + 3
 -y(support: 2)² + z + 3
 -y(support: 3)² + z + 3
 -y(support: 4)² + z + 3
 -y(support: 5)² + z + 3
 -y(support: 6)² + z + 3
 -y(support: 7)² + z + 3
 -y(support: 8)² + z + 3
 -y(support: 9)² + z + 3
 -y(support: 10)² + z + 3</code></pre><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><ol><li>Like <code>supports</code> the <code>optimizer_model_[obj]</code> methods also employ the  <code>label::Type{AbstractSupportLabel} = PublicLabel</code> keyword argument that by  default will return variables/expressions/constraints associated with public  supports. The full set (e.g., ones corresponding to internal collocation nodes)  is obtained via <code>label = All</code>.</li><li>These methods also employ the <code>ndarray::Bool</code> keyword argument that will cause the  output to be formatted as a n-dimensional array where the dimensions  correspond to the infinite parameter dependencies. For example, if we have an  infinite variable <code>y(t, ξ)</code> and we invoke a query method with <code>ndarray = true</code>  then we&#39;ll get a matrix whose dimensions correspond to the supports of <code>t</code> and  <code>ξ</code>, respectively. Also, if <code>ndarray = true</code> then <code>label</code> correspond to the  intersection of supports labels in contrast to its default of invoking the union  of the labels.</li></ol></div></div><p>The purpose of this <code>optimizer_model</code> abstraction is to readily enable user-defined  reformulation extensions (e.g., using polynomial chaos expansion theory). However,  this is all handled behind the scenes such that most users can interact with  <code>InfiniteModel</code>s like any <code>JuMP.Model</code>.</p><h2 id="opt_settings"><a class="docs-heading-anchor" href="#opt_settings">Optimizer Settings</a><a id="opt_settings-1"></a><a class="docs-heading-anchor-permalink" href="#opt_settings" title="Permalink"></a></h2><p>A few optimizer settings can be set in a consistent way agnostic of particular  solver keywords. One such setting is that of suppressing and unsuppressing  optimizer verbose output. This is accomplished via  <a href="../../manual/optimize/#JuMP.set_silent-Tuple{InfiniteModel}"><code>set_silent</code></a> and  <a href="../../manual/optimize/#JuMP.unset_silent-Tuple{InfiniteModel}"><code>unset_silent</code></a>. The syntax is  exemplified below:</p><pre><code class="language-julia-repl">julia&gt; set_silent(model)
true

julia&gt; unset_silent(model)
false</code></pre><p>We can also adjust the time limit in a solver independent fashion via  <a href="../../manual/optimize/#JuMP.set_time_limit_sec-Tuple{InfiniteModel, Any}"><code>set_time_limit_sec</code></a>, <a href="../../manual/optimize/#JuMP.unset_time_limit_sec-Tuple{InfiniteModel}"><code>unset_time_limit_sec</code></a>, and  <a href="../../manual/optimize/#JuMP.time_limit_sec-Tuple{InfiniteModel}"><code>time_limit_sec</code></a>. These methods are illustrated below:</p><pre><code class="language-julia-repl">julia&gt; set_time_limit_sec(model, 100)
100

julia&gt; time_limit_sec(model)
100.0

julia&gt; unset_time_limit_sec(model)</code></pre><p>Other optimizer specific settings can be set via  <a href="../../manual/optimize/#JuMP.set_optimizer_attribute-Tuple{InfiniteModel, String, Any}"><code>set_optimizer_attribute</code></a>. For example, let&#39;s set the maximum CPU time  for Ipopt:</p><pre><code class="language-julia-repl">julia&gt; set_optimizer_attribute(model, &quot;max_cpu_time&quot;, 60.)
60.0</code></pre><p>Multiple settings  can be specified via <a href="../../manual/optimize/#JuMP.set_optimizer_attributes-Tuple{InfiniteModel, Pair}"><code>set_optimizer_attributes</code></a>. For  example, let&#39;s specify the tolerance and the maximum number of iterations:</p><pre><code class="language-julia-repl">julia&gt; set_optimizer_attributes(model, &quot;tol&quot; =&gt; 1e-4, &quot;max_iter&quot; =&gt; 100)</code></pre><p>Finally, we can query optimizer settings via <a href="../../manual/optimize/#JuMP.get_optimizer_attribute-Tuple{InfiniteModel, String}"><code>get_optimizer_attribute</code></a>.  For example, let&#39;s query the maximum number of iterations:</p><pre><code class="language-julia-repl">julia&gt; get_optimizer_attribute(model, &quot;max_iter&quot;)
100</code></pre><p>Note this only works if the attribute has been previously specified.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../transcribe/">« Model Transcription</a><a class="docs-footer-nextpage" href="../result/">Results »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Wednesday 23 June 2021 21:04">Wednesday 23 June 2021</span>. Using Julia version 1.6.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
